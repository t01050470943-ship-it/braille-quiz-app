<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrailleTranslator QA í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Consolas', monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }

        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #252526;
            border-radius: 8px;
        }

        .test-case {
            margin: 15px 0;
            padding: 15px;
            background: #2d2d30;
            border-left: 4px solid #007acc;
        }

        .pass {
            border-left-color: #4ec9b0;
        }

        .fail {
            border-left-color: #f48771;
        }

        h1 {
            color: #4ec9b0;
        }

        h2 {
            color: #569cd6;
            margin-top: 0;
        }

        .status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-weight: bold;
        }

        .status.pass {
            background: #4ec9b0;
            color: #000;
        }

        .status.fail {
            background: #f48771;
            color: #000;
        }

        pre {
            background: #1e1e1e;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>

<body>
    <h1>ğŸ” BrailleTranslator.js QA ê²€ìˆ˜ í…ŒìŠ¤íŠ¸</h1>
    <div id="output"></div>

    <script type="module">
        import BrailleTranslator from './src/engine/BrailleTranslator.js';

        const translator = new BrailleTranslator();
        const output = document.getElementById('output');

        function addSection(title) {
            const section = document.createElement('div');
            section.className = 'test-section';
            section.innerHTML = `<h2>${title}</h2>`;
            output.appendChild(section);
            return section;
        }

        function addTestCase(section, testData) {
            const testCase = document.createElement('div');
            testCase.className = `test-case ${testData.pass ? 'pass' : 'fail'}`;
            testCase.innerHTML = `
                <div><strong>${testData.title}</strong> <span class="status ${testData.pass ? 'pass' : 'fail'}">${testData.pass ? 'âœ… PASS' : 'âŒ FAIL'}</span></div>
                ${testData.details ? `<div style="margin-top: 10px;">${testData.details}</div>` : ''}
                ${testData.result ? `<pre>${testData.result}</pre>` : ''}
            `;
            section.appendChild(testCase);
        }

        // ===== 1. ì œ5í•­: ê²¹ë°›ì¹¨ í…ŒìŠ¤íŠ¸ =====
        const section1 = addSection('[1] Â§5 ê²¹ë°›ì¹¨ ë°ì´í„°ì…‹ í…ŒìŠ¤íŠ¸');

        const clusterTests = [
            { word: 'ë§ë‹¤', cluster: 'ã„¶' },
            { word: 'ì™¸ê³¬', cluster: 'ã„½' },
            { word: 'í•¥ë‹¤', cluster: 'ã„¾' },
            { word: 'ìŠë‹¤', cluster: 'ã„¿' },
            { word: 'ì˜³ë‹¤', cluster: 'ã…€' },
            { word: 'ì—†ë‹¤', cluster: 'ã…„' }
        ];

        clusterTests.forEach(test => {
            const result = translator.translateToBraille(test.word);
            const hasClusterData = translator.clusterFinals[test.cluster] !== undefined;

            addTestCase(section1, {
                title: `${test.cluster} - "${test.word}"`,
                pass: hasClusterData,
                details: `ë°ì´í„° ë“±ë¡: ${hasClusterData ? 'ìˆìŒ' : 'ì—†ìŒ'}`,
                result: `ì í˜•: ${JSON.stringify(result)}`
            });
        });

        // ===== 2. ì œ18í•­: ì•½ì–´ ì• ì˜ˆì™¸ ë¡œì§ í…ŒìŠ¤íŠ¸ =====
        const section2 = addSection('[2] Â§18 ì•½ì–´ ì• ì˜ˆì™¸ ë¡œì§ í…ŒìŠ¤íŠ¸');

        const contractionTests = [
            {
                input: 'ê·¸ë¦¬ê³ ',
                shouldUseContraction: true,
                reason: 'ì•ì— ê¸€ì ì—†ìŒ â†’ ì•½ì–´ ì‚¬ìš© O'
            },
            {
                input: 'ì˜¤ê·¸ë¦¬ê³ ',
                shouldUseContraction: false,
                reason: 'ì•ì— "ì˜¤" ìˆìŒ â†’ ì•½ì–´ ì‚¬ìš© X'
            },
            {
                input: 'ìš°ê·¸ë¦¬ê³ ',
                shouldUseContraction: false,
                reason: 'ì•ì— "ìš°" ìˆìŒ â†’ ì•½ì–´ ì‚¬ìš© X'
            }
        ];

        contractionTests.forEach(test => {
            const result = translator.translateToBraille(test.input);
            const usedContraction = result.length <= 2;
            const passed = usedContraction === test.shouldUseContraction;

            addTestCase(section2, {
                title: `"${test.input}"`,
                pass: passed,
                details: `
                    ì•½ì–´ ì‚¬ìš©: ${usedContraction ? 'YES' : 'NO'} (ì˜ˆìƒ: ${test.shouldUseContraction ? 'YES' : 'NO'})<br>
                    ì í˜• ê°œìˆ˜: ${result.length}<br>
                    ì´ìœ : ${test.reason}
                `,
                result: `ì í˜•: ${JSON.stringify(result)}`
            });
        });

        // ===== 3. ì œ43í•­: ìˆ˜í‘œ ì¬ì‚¬ìš© í…ŒìŠ¤íŠ¸ =====
        const section3 = addSection('[3] Â§43 íŠ¹ìˆ˜ ê¸°í˜¸ ë’¤ ìˆ˜í‘œ ì¬ì‚¬ìš© í…ŒìŠ¤íŠ¸');

        const numberTests = [
            { input: '3Â·1', description: 'ê°€ìš´ëƒì  ë’¤ ìˆ˜í‘œ' },
            { input: '2:1', description: 'ìŒì  ë’¤ ìˆ˜í‘œ' },
            { input: '1-2', description: 'ë¶™ì„í‘œ ë’¤ ìˆ˜í‘œ' }
        ];

        const numberIndicator = [3, 4, 5, 6];
        const isNumberIndicator = (dots) => {
            return JSON.stringify(dots) === JSON.stringify(numberIndicator);
        };

        numberTests.forEach(test => {
            const result = translator.translateToBraille(test.input);

            const indicatorPositions = [];
            result.forEach((dots, idx) => {
                if (isNumberIndicator(dots)) {
                    indicatorPositions.push(idx);
                }
            });

            const hasReusedIndicator = indicatorPositions.length >= 2;

            addTestCase(section3, {
                title: `"${test.input}" (${test.description})`,
                pass: hasReusedIndicator,
                details: `
                    ìˆ˜í‘œ ìœ„ì¹˜: ${JSON.stringify(indicatorPositions)}<br>
                    ìˆ˜í‘œ ê°œìˆ˜: ${indicatorPositions.length} (ì˜ˆìƒ: 2ê°œ)
                `,
                result: `ì í˜•: ${JSON.stringify(result)}`
            });
        });

    </script>
</body>

</html>